## 4.1 数据库设计过程

数据库设计过程：概念设计、逻辑设计、物理设计

## 4.2 实体-联系模型（ER model）

ER模型，将现实世界抽象为**实体**及实体间的**联系**。ER图，是ER模型一种图形化表示方法。

### 4.2.1 与实体相关的概念

实体：数据库中表示的现实世界中的具体对象或事物，例如：员工A、数学系、X项目。
属性：用于刻画实体的特性，例如：员工实体有姓名、性别、身份证号等属性，每个实体的每个属性都有一个值，每个属性都关联着它的取值域。

属性的类型：
简单属性：具有原子属性值，不可再分，例如性别、身份证号、名族等；
复合属性：由多个成分构成的属性，例如地址→（省，市，区）；
多值属性：可具有多个值的属性，例如论文作者、周边餐厅；
派生属性：由其他属性派生出来的属性，例如年龄-出生日期；

实体型：具有相同属性的实体共同具有的类型；
键属性：能将任意两个实体区分开的属性；

### 实体型的ER图表示：

实体型表示为矩形：

<img src="https://i.loli.net/2021/04/12/yiunmOdClt1Hzw4.png" alt="image-20210412104014742" style="zoom:67%;" />

属性表示为椭圆：

* 简单属性为实线椭圆
* 多值属性为双实线椭圆
* 派生属性为虚线椭圆
* 键属性的属性名加下划线

![image-20210412104154993](https://i.loli.net/2021/04/12/2MBSCZGEyW5PlAc.png)

实体型和其属性之间用线连接。

### 4.2.2 与联系相关的概念 

联系型表示为菱形，用直线将联系型与相应的实体联系起来：

<img src="https://i.loli.net/2021/04/14/QNJkYZjbmsuVAhg.png" alt="image-20210414212800064" style="zoom: 50%;" />

若一个实体型和自身联系，需要在ER图中标出实体型参与在联系型中的角色：

<img src="https://i.loli.net/2021/04/14/8UDWqnSbwQTeLjt.png" alt="image-20210414213034868" style="zoom:50%;" />

**基数比：**

刻画实体型参与到联系型中的最大基数
M:N：对实体型1的任意实体e，最多有N个实体型2的实体与e构成联系；对实体型2的任意实体$e'$，最多有M个实体型1的实体与$e'$构成联系

<img src="https://i.loli.net/2021/04/16/BPErotvuhnkSyi1.png" alt="image-20210416081951336" style="zoom:50%;" />

**存在依赖约束：**

刻画实体型参与到联系型中的最小基数(即一个实体最少参与到几个联系中)。有两种情况，0个，表示此实体型部分参与联系，>=1个，表示此实体型全部参与联系，分别用单线和双线表示：

<img src="https://i.loli.net/2021/04/16/JPChGNlfMrHwtEj.png" alt="image-20210416085227491" style="zoom:50%;" />

联系型可以有属性，一般出现在M:N的联系型中；N:1联系型的属性可以被移到N一方的实体型中。

**弱实体型：**没有键属性的实体型，双实线矩形，部分键加虚下划线，标识联系型为双实线菱形

## 总结，设计ER图的步骤：

* 确定实体，画出主键、实体间的联系
* 确定每个联系的基数比、属性、存在依赖约束

<img src="ch4 概念数据库设计.assets/image-20210827213719661.png" alt="image-20210827213719661" style="zoom:50%;" />